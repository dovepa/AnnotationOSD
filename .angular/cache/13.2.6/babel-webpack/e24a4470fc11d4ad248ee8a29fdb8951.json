{"ast":null,"code":"\"use strict\";\n\n/**\n * Queue for all the resources to be download except async scripts.\n * Async scripts have their own queue AsyncResourceQueue.\n */\nmodule.exports = class ResourceQueue {\n  constructor({\n    paused,\n    asyncQueue\n  } = {}) {\n    this.paused = Boolean(paused);\n    this._asyncQueue = asyncQueue;\n  }\n  getLastScript() {\n    let head = this.tail;\n    while (head) {\n      if (head.isScript) {\n        return head;\n      }\n      head = head.prev;\n    }\n    return null;\n  }\n  _moreScripts() {\n    let found = false;\n    let head = this.tail;\n    while (head && !found) {\n      found = head.isScript;\n      head = head.prev;\n    }\n    return found;\n  }\n  _notify() {\n    if (this._listener) {\n      this._listener();\n    }\n  }\n  setListener(listener) {\n    this._listener = listener;\n  }\n  push(request, onLoad, onError, keepLast, element) {\n    const isScript = element ? element.localName === \"script\" : false;\n    if (!request) {\n      if (isScript && !this._moreScripts()) {\n        return onLoad();\n      }\n      request = Promise.resolve();\n    }\n    const q = this;\n    const item = {\n      isScript,\n      err: null,\n      element,\n      fired: false,\n      data: null,\n      keepLast,\n      prev: q.tail,\n      check() {\n        if (!q.paused && !this.prev && this.fired) {\n          let promise;\n          if (this.err && onError) {\n            promise = onError(this.err);\n          }\n          if (!this.err && onLoad) {\n            promise = onLoad(this.data);\n          }\n          Promise.resolve(promise).then(() => {\n            if (this.next) {\n              this.next.prev = null;\n              this.next.check();\n            } else {\n              // q.tail===this\n              q.tail = null;\n              q._notify();\n            }\n            this.finished = true;\n            if (q._asyncQueue) {\n              q._asyncQueue.notifyItem(this);\n            }\n          });\n        }\n      }\n    };\n    if (q.tail) {\n      if (q.tail.keepLast) {\n        // if the tail is the load event in document and we receive a new element to load\n        // we should add this new request before the load event.\n        if (q.tail.prev) {\n          q.tail.prev.next = item;\n        }\n        item.prev = q.tail.prev;\n        q.tail.prev = item;\n        item.next = q.tail;\n      } else {\n        q.tail.next = item;\n        q.tail = item;\n      }\n    } else {\n      q.tail = item;\n    }\n    return request.then(data => {\n      item.fired = 1;\n      item.data = data;\n      item.check();\n    }).catch(err => {\n      item.fired = true;\n      item.err = err;\n      item.check();\n    });\n  }\n  resume() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n    let head = this.tail;\n    while (head && head.prev) {\n      head = head.prev;\n    }\n    if (head) {\n      head.check();\n    }\n  }\n};","map":{"version":3,"names":["module","exports","ResourceQueue","constructor","paused","asyncQueue","Boolean","_asyncQueue","getLastScript","head","tail","isScript","prev","_moreScripts","found","_notify","_listener","setListener","listener","push","request","onLoad","onError","keepLast","element","localName","Promise","resolve","q","item","err","fired","data","check","promise","then","next","finished","notifyItem","catch","resume"],"sources":["/home/dove/Documents/tchek/AnnotationOSD/projects/annotation-osd/node_modules/jsdom/lib/jsdom/browser/resources/resource-queue.js"],"sourcesContent":["\"use strict\";\n\n/**\n * Queue for all the resources to be download except async scripts.\n * Async scripts have their own queue AsyncResourceQueue.\n */\nmodule.exports = class ResourceQueue {\n  constructor({ paused, asyncQueue } = {}) {\n    this.paused = Boolean(paused);\n    this._asyncQueue = asyncQueue;\n  }\n\n  getLastScript() {\n    let head = this.tail;\n\n    while (head) {\n      if (head.isScript) {\n        return head;\n      }\n      head = head.prev;\n    }\n\n    return null;\n  }\n\n  _moreScripts() {\n    let found = false;\n\n    let head = this.tail;\n    while (head && !found) {\n      found = head.isScript;\n      head = head.prev;\n    }\n\n    return found;\n  }\n\n  _notify() {\n    if (this._listener) {\n      this._listener();\n    }\n  }\n\n  setListener(listener) {\n    this._listener = listener;\n  }\n\n  push(request, onLoad, onError, keepLast, element) {\n    const isScript = element ? element.localName === \"script\" : false;\n\n    if (!request) {\n      if (isScript && !this._moreScripts()) {\n        return onLoad();\n      }\n\n      request = Promise.resolve();\n    }\n    const q = this;\n    const item = {\n      isScript,\n      err: null,\n      element,\n      fired: false,\n      data: null,\n      keepLast,\n      prev: q.tail,\n      check() {\n        if (!q.paused && !this.prev && this.fired) {\n          let promise;\n\n          if (this.err && onError) {\n            promise = onError(this.err);\n          }\n\n          if (!this.err && onLoad) {\n            promise = onLoad(this.data);\n          }\n\n          Promise.resolve(promise)\n            .then(() => {\n              if (this.next) {\n                this.next.prev = null;\n                this.next.check();\n              } else { // q.tail===this\n                q.tail = null;\n                q._notify();\n              }\n\n              this.finished = true;\n\n              if (q._asyncQueue) {\n                q._asyncQueue.notifyItem(this);\n              }\n            });\n        }\n      }\n    };\n    if (q.tail) {\n      if (q.tail.keepLast) {\n        // if the tail is the load event in document and we receive a new element to load\n        // we should add this new request before the load event.\n        if (q.tail.prev) {\n          q.tail.prev.next = item;\n        }\n        item.prev = q.tail.prev;\n        q.tail.prev = item;\n        item.next = q.tail;\n      } else {\n        q.tail.next = item;\n        q.tail = item;\n      }\n    } else {\n      q.tail = item;\n    }\n    return request\n      .then(data => {\n        item.fired = 1;\n        item.data = data;\n        item.check();\n      })\n      .catch(err => {\n        item.fired = true;\n        item.err = err;\n        item.check();\n      });\n  }\n\n  resume() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n\n    let head = this.tail;\n    while (head && head.prev) {\n      head = head.prev;\n    }\n    if (head) {\n      head.check();\n    }\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}